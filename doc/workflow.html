<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to eva3dm</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to eva3dm</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(eva3dm)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(riem)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;riem&#39; was built under R version 4.4.3</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; terra 1.8.5</span></span></code></pre></div>
<p>In this Vignette a example of evaluation of temperature at surface
level using data from METeorological Aerodrome Report (METAR).</p>
<p>The recommended workflow to evaluate your model results will include
4 steps 1. Pre-processing of observations 2. Pre-processing of model
output 3. Model Evaluation 4. Visualization</p>
<p>The exact steps needed to evaluation will will be different for
different models, different observation data-set, and different
variable. However, in this example a complete workflow to evaluate the
model using surface stations for one variable.</p>
<ol style="list-style-type: decimal">
<li>Pre-processing of observations:</li>
</ol>
<p>We are using the r-package <code>riem</code> to download METAR
data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>start_date  <span class="ot">&lt;-</span> <span class="st">&quot;2016-01-01&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>end_date    <span class="ot">&lt;-</span> <span class="st">&quot;2016-02-01&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>sites       <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SBGR&quot;</span>,<span class="st">&quot;SBKP&quot;</span>,<span class="st">&quot;SBMT&quot;</span>,<span class="st">&quot;SBSJ&quot;</span>,<span class="st">&quot;SBSP&quot;</span>,<span class="st">&quot;SBST&quot;</span>,<span class="st">&quot;SBTA&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>METAR  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">seq.POSIXt</span>(<span class="fu">as.POSIXct</span>(start_date), </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                                       <span class="fu">as.POSIXct</span>(end_date), </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                                       <span class="at">by =</span> <span class="st">&quot;hour&quot;</span>))</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="cf">for</span>(site <span class="cf">in</span> sites){</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;downloading METAR from:&quot;</span>,site,<span class="st">&quot;...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  DATA <span class="ot">&lt;-</span> <span class="fu">riem_measures</span>(<span class="at">station    =</span> site,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                        <span class="at">date_start =</span> start_date,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                        <span class="at">date_end   =</span> end_date,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                        <span class="at">elev       =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>                        <span class="at">latlon     =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  DATA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> DATA<span class="sc">$</span>valid,</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>                     <span class="at">T2   =</span> DATA<span class="sc">$</span>tmpf)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  <span class="fu">names</span>(DATA) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;date&#39;</span>, site)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  METAR       <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x     =</span> METAR, </span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>                       <span class="at">y     =</span> DATA, </span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>                       <span class="at">by    =</span> <span class="st">&quot;date&quot;</span>, </span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>                       <span class="at">all   =</span> T, </span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>                       <span class="at">sort  =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>}</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBGR ...</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBKP ...</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBMT ...</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBSJ ...</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBSP ...</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBST ...</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; downloading METAR from: SBTA ...</span></span></code></pre></div>
<p>QA of the observation data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot</span>(METAR<span class="sc">$</span>date, METAR[,<span class="dv">2</span>], <span class="at">ty =</span> <span class="st">&#39;l&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;T2&#39;</span>, <span class="at">main =</span> <span class="st">&#39;METAR OBS&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(METAR)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;                  date SBGR SBKP SBMT SBSJ SBSP SBST SBTA</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 1 2015-12-31 19:00:00 75.2 71.6 75.2 77.0 77.0   NA   NA</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 2 2015-12-31 20:00:00 75.2   NA 75.2 77.0 75.2   NA   NA</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 3 2015-12-31 20:01:00   NA   NA   NA   NA 75.2   NA   NA</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 4 2015-12-31 21:00:00 73.4 71.6   NA 77.0 73.4   NA   NA</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 5 2015-12-31 22:00:00 73.4 71.6   NA 75.2 71.6   NA   NA</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 6 2015-12-31 23:00:00 71.6 69.8   NA 75.2   NA   NA   NA</span></span></code></pre></div>
<p>In this case the temperature units need to be converted from
Fahrenheit to Celsius and the data need to be grouped or averaged by
exact hours, in this case using the hourly function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>METAR[,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">9</span> <span class="sc">*</span> (METAR[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">-</span><span class="dv">32</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>METAR      <span class="ot">&lt;-</span> <span class="fu">hourly</span>(METAR)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; processing hourly data ...</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">plot</span>(METAR<span class="sc">$</span>date, METAR[,<span class="dv">2</span>], <span class="at">ty =</span> <span class="st">&#39;l&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;T2&#39;</span>, <span class="at">main =</span> <span class="st">&#39;METAR OBS&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">head</span>(METAR)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;                  date SBGR SBKP SBMT SBSJ     SBSP SBST SBTA</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; 1 2016-01-01 00:00:00   24   22   24   25 25.00000   NA   NA</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; 2 2016-01-01 01:00:00   24   NA   24   25 24.00000   NA   NA</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; 3 2016-01-01 02:00:00   23   22   NA   25 23.00000   NA   NA</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; 4 2016-01-01 03:00:00   23   22   NA   24 22.00000   NA   NA</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; 5 2016-01-01 04:00:00   22   21   NA   24 22.00000   NA   NA</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; 6 2016-01-01 05:00:00   22   21   NA   23 21.33333   NA   NA</span></span></code></pre></div>
<p>For the next step a site-list with latitude and logitude of each
surfacve station is needed, a list of all METAR stations is avaliable in
eva3dm package.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>site_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="at">package=</span><span class="st">&quot;eva3dm&quot;</span>),<span class="st">&quot;/sites_METAR.Rds&quot;</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">head</span>(site_list)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;                      station_name      lat      lon elev      begin  end</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; EHAK A12-CPP HELIPAD OIL PLATFORM 55.39917  3.81028   50 2009-02-09 &lt;NA&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; EKYT                      Aalborg 57.09639  9.85056    3 1940-04-01 &lt;NA&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; EKAH                       Aarhus 56.30833 10.62556   25 1972-12-31 &lt;NA&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; OIAA                       Abadan 30.36667 48.25000   11 1943-11-30 &lt;NA&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; OISA                       ABADEH 31.18333 52.66667 2004 1977-12-01 &lt;NA&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; UNAA                       Abakan 53.74000 91.38500  245 1999-01-14 &lt;NA&gt;</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Pre-processing of model output: model output are large files and and
do not allow the direct comparison with observations. The package
provide a function that extract time-series from geogrephic locations
from a site-list. The function <code>extract_serie()</code> extract the
time-series from a list of files and save the output in R file (in this
example the output is read).</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="do">## to extract time-series from WRF-Chem model</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="do">## wrf_files &lt;- dir(pattern = &quot;wrfout_d01&quot;)</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="do">## extract_serie(filelist = wrf_files, point = site_list, variable=&quot;T2&quot;, prefix=&quot;mmodel.d01&quot;, field=&quot;3d&quot;)</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>model_d01 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="at">package=</span><span class="st">&quot;eva3dm&quot;</span>),<span class="st">&quot;/model.d01.T2.Rds&quot;</span>))</span></code></pre></div>
<p>The function <code>wrf_rast()</code> should be used to evaluate
against observations in regular grids (i.e. satellite products).</p>
<ol start="3" style="list-style-type: decimal">
<li>Model Evaluation: The functions <code>eva()</code> can be used to
calculate the statistical indexes from time-series for individual
stations or all stations combined.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="cf">for</span>(site <span class="cf">in</span> sites){</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  table <span class="ot">&lt;-</span> <span class="fu">eva</span>(<span class="at">mo =</span> model_d01, <span class="at">ob =</span> METAR, <span class="at">site =</span> site, <span class="at">table =</span> table)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>}</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; SBGR has 734 valid observations</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; SBKP has 735 valid observations</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; SBMT has 513 valid observations</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; SBSJ has 740 valid observations</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; SBSP has 737 valid observations</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; SBST has 432 valid observations</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; SBTA has 363 valid observations</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">eva</span>(<span class="at">mo =</span> model_d01, <span class="at">ob =</span> METAR, <span class="at">site =</span> <span class="st">&#39;ALL&#39;</span>, <span class="at">table =</span> table)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; combining all sites...</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; SBGR  SBKP  SBMT  SBSJ  SBSP  SBST  SBTA  ...</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; ALL has 4254 valid observations</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="fu">print</span>(table)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;         n      Obs      Sim         r       IOA FA2     RMSE          MB</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; SBGR  734 22.63965 22.74450 0.7775355 0.8770425   1 2.496525  0.10485920</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; SBKP  735 23.91111 23.85882 0.7727177 0.8686615   1 2.736654 -0.05228941</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; SBMT  513 23.87232 23.84531 0.7422773 0.8552605   1 2.702797 -0.02701357</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; SBSJ  740 23.76284 23.05983 0.7844412 0.8702301   1 2.667141 -0.70301015</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; SBSP  737 22.50583 22.48103 0.7682679 0.8676724   1 2.506979 -0.02480130</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; SBST  432 25.99113 26.09150 0.7568891 0.8657718   1 2.110475  0.10037735</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; SBTA  363 25.77686 26.05061 0.7125727 0.8406234   1 2.921058  0.27374885</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; ALL  4254 23.78823 23.70100 0.7827956 0.8791694   1 2.599433 -0.08723466</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt;            ME    NMB (%)  NME (%)</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; SBGR 1.888910  0.4631662 8.343374</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; SBKP 2.116666 -0.2186825 8.852229</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; SBMT 2.086712 -0.1131585 8.741136</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; SBSJ 2.104004 -2.9584436 8.854178</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; SBSP 1.905254 -0.1101994 8.465600</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; SBST 1.682075  0.3861985 6.471727</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; SBTA 2.345207  1.0619946 9.098112</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; ALL  2.010295 -0.3667135 8.450796</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Visualization: the function <code>overlay()</code> can be used to
plot the results from <code>eva()</code> on a map. First the data is
georeferenced with <code>%at%</code>.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>spatial_table <span class="ot">&lt;-</span> table <span class="sc">%at%</span> site_list</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; georeferencing table at site_list</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">overlay</span>(spatial_table, <span class="at">z =</span> <span class="st">&#39;MB&#39;</span>, <span class="at">main =</span> <span class="st">&#39;T2 main bias (MB)&#39;</span>,<span class="at">expand =</span> <span class="fl">1.6</span>,<span class="at">lim =</span> <span class="fl">0.1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>masp <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">vect</span>(<span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="at">package=</span><span class="st">&quot;eva3dm&quot;</span>),<span class="st">&quot;/masp.shp&quot;</span>))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>BR   <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">vect</span>(<span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="at">package=</span><span class="st">&quot;eva3dm&quot;</span>),<span class="st">&quot;/BR.shp&quot;</span>))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">lines</span>(BR)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">lines</span>(masp, <span class="at">col =</span> <span class="st">&#39;gray&#39;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">legend_range</span>(spatial_table<span class="sc">$</span>MB,<span class="at">y =</span> table[<span class="st">&quot;ALL&quot;</span>,<span class="st">&quot;MB&quot;</span>])</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
